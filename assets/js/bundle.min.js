!function i(u,a,s){function c(e,t){if(!a[e]){if(!u[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(f)return f(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=a[e]={exports:{}};u[e][0].call(o.exports,function(t){return c(u[e][1][t]||t)},o,o.exports,i,u,a,s)}return a[e].exports}for(var f="function"==typeof require&&require,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.states=Array(t).fill(null).map(function(t){return{left:!1,right:!1,action:!1}}),this.statesModified=!1}var t,n,r;return t=e,(n=[{key:"modifyState",value:function(t,e,n){this.states[t][e]!==n&&(this.states[t][e]=n,this.statesModified=!0)}},{key:"getStates",value:function(){if(this.statesModified){var t=this.states;return this.states=this.states.map(function(t){return Object.assign({},t)}),this.statesModified=!1,t}return this.states}}])&&o(t.prototype,n),r&&o(t,r),e}();n.default=r},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=t("./controls"))&&r.__esModule?r:{default:r};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(i){return function(){var t,e,n,r=p(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=p(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(o,i["default"]);var t,e,n,r=l(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,t)}return t=o,(e=[{key:"updateState",value:function(){var e=this;this.states=a(this.states),Array.from(navigator.getGamepads()).filter(function(t){return null!==t&&t.index<e.states.length}).forEach(function(t){e.modifyState(t.index,"left",t.axes[0]<-.5),e.modifyState(t.index,"right",.5<t.axes[0]),e.modifyState(t.index,"action",t.buttons[1].pressed||t.buttons[2].pressed)})}},{key:"getStates",value:function(){return this.updateState(),c(p(o.prototype),"getStates",this).call(this)}}])&&s(t.prototype,e),n&&s(t,n),o}();n.default=d},{"./controls":1}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=t("./controls"))&&r.__esModule?r:{default:r};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(i){return function(){var t,e,n,r=c(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f={ArrowLeft:{id:0,prop:"left"},ArrowRight:{id:0,prop:"right"},ArrowDown:{id:0,prop:"action"},KeyA:{id:1,prop:"left"},KeyD:{id:1,prop:"right"},KeyS:{id:1,prop:"action"}},o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,i["default"]);var e=s(o);function o(n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r=e.call(this,n);function t(t){var e=f[t.code];e&&e.id<n&&r.modifyState(e.id,e.prop,"keydown"===t.type)}return window.addEventListener("keydown",t),window.addEventListener("keyup",t),r}return o}();n.default=o},{"./controls":1}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=t("./controls"))&&r.__esModule?r:{default:r};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(i){return function(){var t,e,n,r=f(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=f(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,i["default"]);var t,e,n,r=c(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).element=document.createElement("div"),e.element.classList.add("screen-controls"),e.element.classList.add("with-".concat(t,"-controls"));for(var n=0;n<e.states.length;++n)e.element.appendChild(e.buildControl(n));return e.mousePressedButton=null,window.addEventListener("mouseup",function(){null!==e.mousePressedButton&&(e.modifyState(e.mousePressedButton.id,e.mousePressedButton.name,!1),e.mousePressedButton.element.classList.remove("active"),e.mousePressedButton=null)}),e}return t=o,(e=[{key:"buildControl",value:function(r){var o=this,t=document.createElement("div");t.classList.add("screen-control","screen-control-".concat(r));function e(e){var n=document.createElement("button");function t(t){0<t.targetTouches.length?(o.modifyState(r,e,!0),n.classList.add("active")):(o.modifyState(r,e,!1),n.classList.remove("active")),t.preventDefault()}return n.setAttribute("type","button"),n.classList.add(e),n.addEventListener("touchstart",t,{passive:!1}),n.addEventListener("touchmove",t,{passive:!1}),n.addEventListener("touchend",t,{passive:!1}),n.addEventListener("touchcancel",t,{passive:!1}),n.addEventListener("mousedown",function(){o.modifyState(r,e,!0),n.classList.add("active"),o.mousePressedButton={id:r,name:e,element:n}}),n}return t.appendChild(e("left")),t.appendChild(e("action")),t.appendChild(e("right")),t}}])&&a(t.prototype,e),n&&a(t,n),o}();n.default=o},{"./controls":1}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=(r=t("./game-mode"))&&r.__esModule?r:{default:r};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function f(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){c(r,e,n,o,i,"next",t)}function i(t){c(r,e,n,o,i,"throw",t)}o(void 0)})}}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(i){return function(){var t,e,n,r=a(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=a(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,s["default"]);var t,e,n,r,o,i,u=d(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),u.apply(this,arguments)}return t=a,(e=[{key:"preLoadAssets",value:(i=f(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return i.apply(this,arguments)})},{key:"handleEnterMode",value:(o=f(regeneratorRuntime.mark(function t(){var e,n,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=$(this.game.overlay),n=this.game.config.maxPlayers,this.selectedNumber=1,this.selectorItems={},$('<div class="text text-center numPlayers-title" />').text(IMAGINARY.i18n.t("choose-num-players")).appendTo(e),r=$('<div class="numPlayers-selector" />').addClass("numPlayers-selector-with-".concat(n)).appendTo(e),o=1;o<=n;o+=1)this.selectorItems[o]=$('<div class="item" />').addClass("item-".concat(o)).toggleClass("selected",this.selectedNumber===o).text(o).appendTo(r);case 7:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})},{key:"handleExitMode",value:(r=f(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})},{key:"handleInputs",value:function(t,n){var e=this.game.config.maxPlayers,r=null;t.find(function(t,e){return-1===t.direction&&-1!==n[e].direction})?r=Math.max(1,this.selectedNumber-1):t.find(function(t,e){return 1===t.direction&&1!==n[e].direction})&&(r=Math.min(e,this.selectedNumber+1)),r&&r!==this.selectedNumber&&(this.selectorItems[this.selectedNumber].removeClass("selected"),this.selectorItems[r].addClass("selected"),this.selectedNumber=r),t.find(function(t,e){return t.action&&!n[e].action})&&(this.game.numPlayers=this.selectedNumber,this.triggerEvent("done"))}},{key:"draw",value:function(){}}])&&l(t.prototype,e),n&&l(t,n),a}();n.default=o},{"./game-mode":8}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=(r=t("./game-mode"))&&r.__esModule?r:{default:r};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function f(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){c(r,e,n,o,i,"next",t)}function i(t){c(r,e,n,o,i,"throw",t)}o(void 0)})}}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(i){return function(){var t,e,n,r=a(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=a(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,s["default"]);var t,e,n,r,o,i,u=d(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),u.apply(this,arguments)}return t=a,(e=[{key:"preLoadAssets",value:(i=f(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.game.loadSVGSymbol("assets/img/ship.svg");case 2:this.shipSymbol=t.sent;case 3:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)})},{key:"handleEnterMode",value:(o=f(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.game,n=e.draw,e.numPlayers,n.line(0,200,1920,200).stroke({color:"#9999ff",width:2}),this.boat=n.use(this.shipSymbol).size(300,200).stroke({color:"#ff0000",width:2}).fill("transparent").center(300,165),window.myBoat=this.boat;case 4:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})},{key:"handleExitMode",value:(r=f(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})},{key:"handleInputs",value:function(){}},{key:"draw",value:function(t,e){var n=this.game;n.draw,n.numPlayers}}])&&l(t.prototype,e),n&&l(t,n),a}();n.default=o},{"./game-mode":8}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=r(t("./game-mode")),c=r(t("./wavy-animation"));function r(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function l(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){f(r,e,n,o,i,"next",t)}function i(t){f(r,e,n,o,i,"throw",t)}o(void 0)})}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(i){return function(){var t,e,n,r=a(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=a(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,s["default"]);var t,e,n,r,o,i,u=h(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),u.apply(this,arguments)}return t=a,(e=[{key:"preLoadAssets",value:(i=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.game.loadSVGSymbol("assets/img/descent-logo.svg");case 2:this.logoSprite=t.sent,this.poly=this.logoSprite.findOne("#descent");case 4:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)})},{key:"handleEnterMode",value:(o=l(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.game.draw,(n=document.createElement("div")).classList.add("blinking","text","text-center","text-vcenter"),n.textContent=IMAGINARY.i18n.t("press-to-start"),this.game.overlay.append(n),e.use(this.logoSprite).size(1200,400).stroke({color:"#00368a",width:2}).fill("transparent").center(960,432).animate({duration:5e3}).stroke({color:"#34c6ff"}),this.wavyStep=(0,c.default)(this.logoSprite,{duration:3500}),this.animCounter=0;case 9:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})},{key:"handleExitMode",value:(r=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})},{key:"handleInputs",value:function(t,n){t.find(function(t,e){return t.action&&!n[e].action})&&this.triggerEvent("done")}},{key:"draw",value:function(t,e){this.wavyStep(t,e)}}])&&p(t.prototype,e),n&&p(t,n),a}();n.default=o},{"./game-mode":8,"./wavy-animation":11}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,a=(r=t("events"))&&r.__esModule?r:{default:r};function s(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function c(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){s(r,e,n,o,i,"next",t)}function i(t){s(r,e,n,o,i,"throw",t)}o(void 0)})}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.events=new a.default}var t,n,r,o,i,u;return t=e,(n=[{key:"preLoadAssets",value:(u=c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return u.apply(this,arguments)})},{key:"handleEnterMode",value:(i=c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return i.apply(this,arguments)})},{key:"handleExitMode",value:(o=c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(){return o.apply(this,arguments)})},{key:"handleInputs",value:function(){}},{key:"draw",value:function(){}},{key:"triggerEvent",value:function(t){this.events.emit(t)}}])&&f(t.prototype,n),r&&f(t,r),e}();n.default=o},{events:12}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=r(t("./game-mode-play")),c=r(t("./game-mode-title")),f=r(t("./game-mode-numplayers")),l=r(t("./controls/gamepad")),p=r(t("./controls/screen")),d=r(t("./controls/keyboard"));function r(t){return t&&t.__esModule?t:{default:t}}function h(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function y(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){h(r,e,n,o,i,"next",t)}function i(t){h(r,e,n,o,i,"throw",t)}o(void 0)})}}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.container=t,this.config=e,this.inputs=this.createInputs(),this.inputsLast=this.createInputs(),this.isPaused=!1,this.modes={},this.currentMode=null,this.controls={},this.debugControlsPane=null,this.numPlayers=this.config.maxPlayers}var t,e,r,o,i,u,a;return t=n,(e=[{key:"init",value:(a=y(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.svgDoc=SVG().addTo(this.container).size(500,500),this.draw=this.svgDoc.nested(),this.overlay=document.createElement("div"),this.overlay.classList.add("overlay"),this.container.append(this.overlay),this.config.useScreenControls&&(this.controls.screen=new p.default(this.config.maxPlayers),this.container.appendChild(this.controls.screen.element)),this.config.useGamepads&&(this.controls.gamepad=new l.default(this.config.maxPlayers)),this.config.useKeyboardControls&&(this.controls.keyboard=new d.default(this.config.maxPlayers)),this.config.debugControls&&(this.debugControlsPane=document.createElement("div"),this.debugControlsPane.classList.add("debug-pane"),this.debugControlsPane.classList.add("debug-pane-controls"),this.container.appendChild(this.debugControlsPane)),t.next=11,this.registerMode("title",new c.default(this));case 11:return t.next=13,this.registerMode("numplayers",new f.default(this));case 13:return t.next=15,this.registerMode("play",new s.default(this));case 15:if(this.config.continuousGame)return this.transition("play","done","play"),t.next=19,this.setMode("play");t.next=21;break;case 19:t.next=26;break;case 21:return this.transition("title","done",1<this.config.maxPlayers?"numplayers":"play"),this.transition("numplayers","done","play"),this.transition("play","done","title"),t.next=26,this.setMode("title");case 26:case"end":return t.stop()}},t,this)})),function(){return a.apply(this,arguments)})},{key:"loadSVGSymbol",value:(u=y(regeneratorRuntime.mark(function t(e){var n,r,o,i=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(1<i.length&&void 0!==i[1])||i[1],t.next=3,fetch(e);case 3:if((r=t.sent).status<200||300<=r.status)throw new Error("Server returned status ".concat(r.status," (").concat(r.statusText,") loading ").concat(e,"."));t.next=6;break;case 6:return t.t0=this.svgDoc.symbol(),t.next=9,r.text();case 9:return t.t1=t.sent,o=t.t0.svg.call(t.t0,t.t1),n&&o.find("style").forEach(function(t){return t.remove()}),t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"initInputs",value:function(){this.inputs=this.createInputs()}},{key:"createInputs",value:function(){return Array(this.config.maxPlayers).fill(null).map(function(){return{direction:0,action:!1}})}},{key:"readInputs",value:function(){this.inputsLast=this.inputs;function n(t,e){return{direction:e.right?1:e.left?-1:t.direction,action:e.action||t.action}}var r=Object.values(this.controls).map(function(t){return t.getStates()});this.inputs=this.createInputs().map(function(t,e){return r.map(function(t){return t[e]}).reduce(n,t)}),this.debugControlsPane&&(this.debugControlsPane.textContent=this.inputs.map(function(t,e){return"C".concat(e,": d=").concat(t.direction," a=").concat(t.action?"T":"F")}).join("    "))}},{key:"run",value:function(){var n=this,r=0;window.requestAnimationFrame(function t(e){n.isPaused||(n.readInputs(),n.currentMode.handleInputs(n.inputs,n.inputsLast),n.currentMode.draw(Math.min(e-r,125),e),r=e,window.requestAnimationFrame(t))})}},{key:"pause",value:function(){this.isPaused=!0}},{key:"resume",value:function(){this.isPaused&&(this.isPaused=!1,this.run())}},{key:"registerMode",value:(i=y(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.modes[e]=n,t.next=3,n.preLoadAssets();case 3:case"end":return t.stop()}},t,this)})),function(t,e){return i.apply(this,arguments)})},{key:"setMode",value:(o=y(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.pause(),this.currentMode)return t.next=4,this.currentMode.handleExitMode();t.next=4;break;case 4:if(void 0===this.modes[e])throw new Error("Can't change to unknown mode ".concat(e));t.next=6;break;case 6:return this.currentMode=this.modes[e],this.draw.clear(),this.overlay.innerHTML="",t.next=11,this.currentMode.handleEnterMode();case 11:this.resume();case 12:case"end":return t.stop()}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"transition",value:function(t,e,n,r){var o=this,i=2<arguments.length&&void 0!==n?n:null,u=3<arguments.length&&void 0!==r?r:null;if(void 0===this.modes[t])throw new Error("Can't define transition from unknown game mode '".concat(t,"'"));if(i&&void 0===this.modes[i])throw new Error("Can't define transition to unknown game mode '".concat(i,"'"));this.modes[t].events.on(e,function(){if(o.currentMode!==o.modes[t])throw new Error("Mode ".concat(t," triggered the event ").concat(e," while not active. Something was not cleaned up?"));null!==i&&o.setMode(i),u&&"function"==typeof u&&u()})}}])&&m(t.prototype,e),r&&m(t,r),n}();n.default=o},{"./controls/gamepad":2,"./controls/keyboard":3,"./controls/screen":4,"./game-mode-numplayers":5,"./game-mode-play":6,"./game-mode-title":7}],10:[function(t,e,n){"use strict";var r,o=(r=t("./game"))&&r.__esModule?r:{default:r};function s(t,e,n,r,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void n(t)}a.done?e(s):Promise.resolve(s).then(r,o)}function i(a){return function(){var t=this,u=arguments;return new Promise(function(e,n){var r=a.apply(t,u);function o(t){s(r,e,n,o,i,"next",t)}function i(t){s(r,e,n,o,i,"throw",t)}o(void 0)})}}var u,a={defaultLanguage:"en",useGamepads:!0,useScreenControls:!0,maxPlayers:2,continuousGame:!1,debugControls:!1};function c(){return f.apply(this,arguments)}function f(){return(f=i(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if(200<=(n=t.sent).status&&n.status<300)return t.prev=4,t.next=7,n.json();t.next=13;break;case 7:return t.abrupt("return",t.sent);case 10:throw t.prev=10,t.t0=t.catch(4),new Error("Error parsing config file: ".concat(t.t0.message));case 13:throw new Error("Server returned status ".concat(n.status," (").concat(n.statusText,") loading config file."));case 14:case"end":return t.stop()}},t,null,[[4,10]])}))).apply(this,arguments)}u=i(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=Object,t.t1={},t.t2=a,t.next=6,c("./config.json");case 6:return t.t3=t.sent,e=t.t0.assign.call(t.t0,t.t1,t.t2,t.t3),t.next=10,IMAGINARY.i18n.init({queryStringVariable:"lang",translationsDirectory:"tr",defaultLanguage:e.defaultLanguage||"en"});case 10:return n=new o.default(document.querySelector(".main"),e),t.next=13,n.init();case 13:t.next=18;break;case 15:t.prev=15,t.t4=t.catch(0),console.error(t.t4);case 18:case"end":return t.stop()}},t,null,[[0,15]])})),function(){u.apply(this,arguments)}()},{"./game":9}],11:[function(t,e,n){"use strict";function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},{xAmplitude:50,duration:5e3,cycles:3},e),n=t.find("polygon"),r=n.map(function(t){return t.plot()}),u=Math.max.apply(Math,function(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r.flat().map(function(t){return s(t,2)[1]}))),a=0;return function(t,e){if(!(a>i.duration)){a+=t;var o=Math.min(a,i.duration)/i.duration;n.forEach(function(t,e){t.plot(r[e].map(function(t){var e=s(t,2),n=e[0],r=e[1];return[n+Math.sin((r/u+o*i.cycles)*Math.PI*2)*i.xAmplitude*(1-Math.pow(o,2)),r]}))})}}}},{}],12:[function(t,e,n){var s=Object.create||function(t){function e(){}return e.prototype=t,new e},u=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},i=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((e.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0;var o,a=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(t){o=!1}function f(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function l(t,e,n,r){var o,i,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=t._events)?(i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),u=i[e]):(i=t._events=s(null),t._eventsCount=0),u){if("function"==typeof u?u=i[e]=r?[n,u]:[u,n]:r?u.unshift(n):u.push(n),!u.warned&&(o=f(t))&&0<o&&u.length>o){u.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+u.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=u.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message)}}else u=i[e]=n,++t._eventsCount;return t}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=i.call(p,r);return o.listener=n,r.wrapFn=o}function h(t,e,n){var r=t._events;if(!r)return[];var o=r[e];return o?"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):m(o,o.length):[]}function y(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}o?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');a=t}}):r.defaultMaxListeners=a,r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return f(this)},r.prototype.emit=function(t,e,n,r){var o,i,u,a,s,c,f="error"===t;if(c=this._events)f=f&&null==c.error;else if(!f)return!1;if(f){if(1<arguments.length&&(o=e),o instanceof Error)throw o;var l=new Error('Unhandled "error" event. ('+o+")");throw l.context=o,l}if(!(i=c[t]))return!1;var p="function"==typeof i;switch(u=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,o=m(t,r),i=0;i<r;++i)o[i].call(n)}(i,p,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var o=t.length,i=m(t,o),u=0;u<o;++u)i[u].call(n,r)}(i,p,this,e);break;case 3:!function(t,e,n,r,o){if(e)t.call(n,r,o);else for(var i=t.length,u=m(t,i),a=0;a<i;++a)u[a].call(n,r,o)}(i,p,this,e,n);break;case 4:!function(t,e,n,r,o,i){if(e)t.call(n,r,o,i);else for(var u=t.length,a=m(t,u),s=0;s<u;++s)a[s].call(n,r,o,i)}(i,p,this,e,n,r);break;default:for(a=new Array(u-1),s=1;s<u;s++)a[s-1]=arguments[s];!function(t,e,n,r){if(e)t.apply(n,r);else for(var o=t.length,i=m(t,o),u=0;u<o;++u)i[u].apply(n,r)}(i,p,this,a)}return!0},r.prototype.on=r.prototype.addListener=function(t,e){return l(this,t,e,!1)},r.prototype.prependListener=function(t,e){return l(this,t,e,!0)},r.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,d(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,d(this,t,e)),this},r.prototype.removeListener=function(t,e){var n,r,o,i,u;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=s(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===e||n[i].listener===e){u=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(var n=e,r=n+1,o=t.length;r<o;n+=1,r+=1)t[n]=t[r];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),r.removeListener&&this.emit("removeListener",t,u||e)}return this},r.prototype.removeAllListeners=function(t){var e,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=s(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=s(null):delete n[t]),this;if(0===arguments.length){var o,i=u(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(r=e.length-1;0<=r;r--)this.removeListener(t,e[r]);return this},r.prototype.listeners=function(t){return h(this,t,!0)},r.prototype.rawListeners=function(t){return h(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},r.prototype.listenerCount=y,r.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}]},{},[10]);
//# sourceMappingURL=bundle.min.js.map
